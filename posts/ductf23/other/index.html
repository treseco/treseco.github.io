<!DOCTYPE html>
<html class="" lang="en"><head>
    
    <meta name="viewport" content="width=device-width" />
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=7" />

    <link
    rel="icon"
    href='/favicon.png'
/>
<link
    rel="shortcut icon"
    href='/favicon.ico'
    type="image/x-icon"
/>
<link
    rel="apple-touch-icon"
    href='/apple-touch-icon.png'
/>

    <link
        rel="icon"
        href='/logo.svg'
        type="image/svg+xml"
    />

<title>
        
            DUCTF solves  &ndash;
        
        CT
    </title>

    
    <link href="/symbols-nerd-font/symbols-nerd-font.css" rel="stylesheet" integrity="sha512-lydow8GLOLlYNOtHlksNCmGWWCBsbIEtikXpHzfWqx78HLlyQZHOzyLwPpKol4Th6aCwLUXOfODVYgwrd3nwKQ=="/>
    <link href="/jetbrains-mono/jetbrains-mono.css" rel="stylesheet" integrity="sha512-tJxlgL6v1Y7kFf+qB8SloaAMKnOAw6WouknxXtIjkBux9Y/9aX81EUWOJO8c/3l98DmjG8brr4to7zaez606Fg=="/>

    
    
    <link type="text/css" rel="stylesheet" href=https://treseco.github.io/css/styles.0ea3e9989fc6c27bb0498cd610b6d9ded6962526e50b505d3792fd0711d4f9e482dc5d2aa5b4354def56902c72e5c414a550694cf084d53366e19485f2fdc477.css integrity="sha512-DqPpmJ/GwnuwSYzWELbZ3taWJSblC1BdN5L9BxHU&#43;eSC3F0qpbQ1Te9WkCxy5cQUpVBpTPCE1TNm4ZSF8v3Edw==" />
<meta name="author" content="" />

    
        <meta name="keywords" content='ctf write-up, DUCTF 2023, misc, OSINT, reversing' />
    
    
        <meta name="description" content="uthor: Pix Category: rev Difficulty: beginner Points: 100 Solves: 270 Description We found this binary in the backroom, its been marked as &amp;ldquo;The All Fathers Wisdom&amp;rdquo; - See hex for further details. Not sure if its just old and hex should be text, or they mean the literal hex.
Anyway can you get this &amp;lsquo;wisdom&amp;rsquo; out of the binary for us?
Files the-all-fathers-wisdom - ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64." />
    

<meta property="og:site_name"
    content='CT' />

    <meta property="og:title" content="DUCTF solves" />
    <meta property="og:type" content="article" />
    
    <meta
        property="article:author" content="" />
    <meta
        property="article:published_time"
        content='2023-09-03T16:05:08Z-0500' />
    
        
            <meta property="article:tag" content="ctf write-up" />
        
            <meta property="article:tag" content="DUCTF 2023" />
        
            <meta property="article:tag" content="misc" />
        
            <meta property="article:tag" content="OSINT" />
        
            <meta property="article:tag" content="reversing" />
        
    
    <meta property="og:url" content="https://treseco.github.io/posts/ductf23/other/" />
    
    
    <meta property="og:image"
        content="https://treseco.github.io/icon512.png" />
    
        <meta property="og:description" content="All Fathers Wisdom Author: Pix Category: rev Difficulty: beginner Points: 100 Solves: 270 Description We found this binary in the backroom, its been marked as &amp;" />
    

<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:domain"
      content='reseco.github.io'
/>
<meta property="twitter:url" content="https://treseco.github.io/posts/ductf23/other/" />


    <meta name="twitter:title" content="DUCTF solves" />
    
    
    
    <meta name="twitter:image"
        content="https://treseco.github.io/icon512.png" />
    
        <meta name="twitter:description" content="All Fathers Wisdom Author: Pix Category: rev Difficulty: beginner Points: 100 Solves: 270 Description We found this binary in the backroom, its been marked as &amp;" />
    

<link rel="manifest" href="/manifest/index.json" />
</head>


<body>
        <div id="baseContainer"><header class="">
<div class="titleAndSearchContainer">
        <div id="titleContainer">
            
                <a class="unstyledLink" href="/">
                    <img src='/logo.svg' alt='Logo'/>
                </a>
            
            <div class="rightOfLogo">
                <div class="titleAndHamburger">
                    <h1>
                        <a class="unstyledLink" href="/">CT</a>
                        
                    </h1>
                    
                        <label id="hamburger-menu" for="main-nav-toggler">
                            &#xf85b;
                        </label>
                    
                </div>
                <div id="wide_nav"><nav>
    
        <input type="checkbox" id="main-nav-toggler" />
    
    <ul id="main-nav">
        <li><a href="/">Home</a></li>
        
            <li><a href="/posts/">Posts</a></li>
        
        
        
        
        
            <li><a href="https://treseco.github.io/pages/about/">
                About
            </a></li>
        
        
        
            <li><a href="/tags/">Tags</a></li>
        
        
    </ul>
</nav>
</div>
            </div>
        </div>
        <div class="search">
    <input id="searchbar" type="text" placeholder='Search' />
    <span class="nerdlink" onclick="newSearch();">&#xf002;</span>
</div>
<script>
    function newSearch() {
        let term = searchbar.value.trim();
        if (!term) return;
        location.href = `/search/?q=${term}`;
    }
    searchbar.onkeyup = (ev) => {if (ev.keyCode == 13) newSearch()};
</script>

    </div>
    <div id="links">
        
        
        <a
    
        rel="noreferrer"
    
    target="_blank"
    class="nerdlink"
    href="https://github.com/treseco">
    
    
        &#xf09b;
    
    <span>
        Github
    </span>
</a>

    </div>
    

</header>
<div id="contentContainer">
                <div id="content">
                    <main>
<article class="card single">
    
        <h1>DUCTF solves</h1>
    
    
        <p class="date">
            <span title='Date'> </span>
    2023-09-03

</p>
    
    
    
    
    <div><h3 id="all-fathers-wisdom">All Fathers Wisdom</h3>
<ul>
<li>Author: Pix</li>
<li>Category: rev</li>
<li>Difficulty: beginner</li>
<li>Points: 100</li>
<li>Solves: 270</li>
</ul>
<hr>
<h4 id="description">Description</h4>
<blockquote>
<p>We found this binary in the backroom, its been marked as &ldquo;The All Fathers Wisdom&rdquo; - See hex for further details. Not sure if its just old and hex should be text, or they mean the literal hex.</p>
<p>Anyway can you get this &lsquo;wisdom&rsquo; out of the binary for us?</p>
</blockquote>
<hr>
<h4 id="files">Files</h4>
<p><code>the-all-fathers-wisdom</code> - ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=01eec917a381d4efe62ed137f1349127f4faeeaa, for GNU/Linux 4.4.0, not stripped</p>
<hr>
<h4 id="solve">Solve</h4>
<p>The given file still includes the function names, so when we decompile it doesn&rsquo;t take long to find the function <code>main.print_flag()</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> main.<span style="color:#a6e22e">print_flag</span>(undefined8 flag) {
</span></span><span style="display:flex;"><span>  uint xor_res;
</span></span><span style="display:flex;"><span>  undefined local_228 [<span style="color:#ae81ff">16</span>];
</span></span><span style="display:flex;"><span>  undefined local_218 [<span style="color:#ae81ff">16</span>];
</span></span><span style="display:flex;"><span>  undefined local_208 [<span style="color:#ae81ff">16</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">long</span> i;
</span></span><span style="display:flex;"><span>  undefined8 <span style="color:#f92672">*</span>end;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">long</span> bound;
</span></span><span style="display:flex;"><span>  undefined8 local_1d8;
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>	...
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>  undefined8 local_8;
</span></span><span style="display:flex;"><span>  undefined8 <span style="color:#f92672">*</span>end_ptr;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">long</span> j;
</span></span><span style="display:flex;"><span>  local_8 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x75</span>;
</span></span><span style="display:flex;"><span>  local_10 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x26</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	...  
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>  local_1d0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x25</span>;
</span></span><span style="display:flex;"><span>  local_1d8 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x25</span>;
</span></span><span style="display:flex;"><span>  end <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>local_1d8;
</span></span><span style="display:flex;"><span>  bound <span style="color:#f92672">=</span> <span style="color:#ae81ff">59</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; end_ptr <span style="color:#f92672">=</span> end, j <span style="color:#f92672">=</span> i, i <span style="color:#f92672">&lt;</span> bound; i <span style="color:#f92672">=</span> i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    runtime.<span style="color:#a6e22e">bounds_check_error</span>();
</span></span><span style="display:flex;"><span>    xor_res <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(uint <span style="color:#f92672">*</span>)(end_ptr <span style="color:#f92672">+</span> j) <span style="color:#f92672">^</span> <span style="color:#ae81ff">0x11</span>;
</span></span><span style="display:flex;"><span>    local_228 <span style="color:#f92672">=</span> <span style="color:#a6e22e">CONCAT88</span>(<span style="color:#ae81ff">0x4200000000000001</span>,<span style="color:#f92672">&amp;</span>xor_res);
</span></span><span style="display:flex;"><span>    local_218 <span style="color:#f92672">=</span> <span style="color:#a6e22e">CONCAT88</span>(<span style="color:#ae81ff">0x4200000000000001</span>,<span style="color:#f92672">&amp;</span>xor_res);
</span></span><span style="display:flex;"><span>    local_208 <span style="color:#f92672">=</span> <span style="color:#a6e22e">CONCAT88</span>(<span style="color:#ae81ff">1</span>,local_218);
</span></span><span style="display:flex;"><span>    fmt.<span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;%c&#34;</span>,<span style="color:#ae81ff">2</span>,local_218,<span style="color:#ae81ff">1</span>,flag);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>This function has many local variables that are assigned values. The for loop interates over the values, xors them with <code>0x11</code>, then prints them. We can can copy these values into a python script to compute the xor and print the flag.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># byte values in the local vars in main.print_flag() from ghidra</span>
</span></span><span style="display:flex;"><span>bytes<span style="color:#f92672">=</span><span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x75\x26\x31\x22\x25\x31\x77\x24\x31\x25\x26\x31\x21\x22\x31\x74\x25\x31\x75\x23\x31\x22\x24\x31\x20\x22\x31\x77\x24\x31\x74\x27\x31\x20\x22\x31\x25\x27\x31\x77\x25\x31\x73\x26\x31\x27\x25\x31\x25\x24\x31\x22\x25\x31\x24\x24\x31\x25\x25</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>decode <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># xor each byte and append it to decode. ignore spaces.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> b <span style="color:#f92672">in</span> bytes:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> b <span style="color:#f92672">!=</span> <span style="color:#ae81ff">49</span>:
</span></span><span style="display:flex;"><span>        decode <span style="color:#f92672">+=</span> chr(b <span style="color:#f92672">^</span> <span style="color:#ae81ff">17</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># reverse the string. the program loops opposite to how we copied the data</span>
</span></span><span style="display:flex;"><span>decode <span style="color:#f92672">=</span> decode[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>:: <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># convert the decoded hex codes into ascii and print</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, len(decode), <span style="color:#ae81ff">2</span>):
</span></span><span style="display:flex;"><span>    print(chr(int(decode[i:i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>], <span style="color:#ae81ff">16</span>)), end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>print()
</span></span></code></pre></div><p><code>DUCTF{Od1n_1S-N0t_C}</code></p>
<hr>
<h3 id="monke-bars">Monke Bars</h3>
<ul>
<li>Author: ghostccamm</li>
<li>Category: osint</li>
<li>Difficulty: easy</li>
<li>Points: 100</li>
<li>Solves: 281</li>
</ul>
<hr>
<h4 id="description-1">Description</h4>
<blockquote>
<p>I will be dropping my new track <strong>monke bars</strong> soon! But I suck at rap and don&rsquo;t want to share it&hellip;</p>
<p><em>Can you find the song?</em></p>
<p>NOTE: Flag is in the format <code>DUCTF{...}</code> with no spaces and all lowercase between the <code>{}</code> characters. e.g. DUCTF{icannotrap}</p>
</blockquote>
<hr>
<h4 id="solve-1">Solve</h4>
<p>The description tells us we need to find a song <strong>monke bars</strong>, and that the artist is not so good. A search on <a href="https://soundcloud.com/mc-fat-monke/monke-bars">Soundcloud</a> for &ldquo;monke bars&rdquo; yields a song were the artist has left the comment:
<code>D-U-C-T-F left curly bracket smack it hack it drop that packet crack this track right curly bracket</code>. From this we can get the flag.</p>
<p><code>DUCTF{smackithackitdropthatpacketcrackthistrack}</code></p>
<hr>
<h3 id="my-first-c-program">My First C Program</h3>
<ul>
<li>Author: Pix</li>
<li>Category: misc</li>
<li>Difficulty: easy</li>
<li>Points: 100</li>
<li>Solves: 315</li>
</ul>
<hr>
<h4 id="description-2">Description</h4>
<blockquote>
<p>I decided to finally sit down and learn C, and I don&rsquo;t know what all the fuss is about this language it writes like a <em><strong>dream</strong></em>!</p>
<p>Here is my first challenge in C! Its really easy after you install the C installer installer, after that you just run it and you&rsquo;re free to fly away with the flag like a <em><strong>berd</strong></em>!</p>
</blockquote>
<hr>
<h4 id="files-1">Files</h4>
<p><code>my_first_c_prog.c</code> - ASCII text</p>
<hr>
<h4 id="solve-2">Solve</h4>
<p><code>my_first_c_prog.c</code> contains a poorly written program in c. The program first sets the values of some variables and then prints out the flag by combining the values of the variables in the following function:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>   <span style="color:#66d9ef">union</span> <span style="color:#a6e22e">print_flag</span>(end, middle, secondmiddle, start, realstart) <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">print</span>(<span style="color:#e6db74">&#34;The flag is:&#34;</span>)<span style="color:#f92672">!</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">print</span>(<span style="color:#e6db74">&#34;DUCTF{${start}_${realstart}_${end}_${secondmiddle}_1s_${middle}_C}&#34;</span>)<span style="color:#f92672">!!!</span>
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Now to print the flag for the CTF!!
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">print_flag</span>(thank, vars[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>], end, heck_eight, ntino)
</span></span></code></pre></div><p>For each argument to the <code>print_flag</code> function we can determine its value by interpreting and correcting the rest of the program.</p>
<p><code>DUCTF{I_D0nT_Th1nk_th15_1s_R34L_C}</code></p>
</div>
</article>

    <hr />
    <p class="articleTagsContainer">
        <span> </span>
        <strong>Tags:</strong>
        
            <a
                
                href="/tags/ctf-write-up/">#ctf write-up</a>
        
            <a
                
                href="/tags/ductf-2023/">#DUCTF 2023</a>
        
            <a
                
                href="/tags/misc/">#misc</a>
        
            <a
                
                href="/tags/osint/">#OSINT</a>
        
            <a
                
                href="/tags/reversing/">#reversing</a>
        
    </p>






                    </main><footer>
    <hr />

<p><small>
        2023 &copy; 
    </small></p>
    <p><small>
        <a href='https://gitlab.com/gabmus/hugo-ficurinia'>Ficurinia theme</a> for <a href='https://gohugo.io'>Hugo</a> by <a href='https://gabmus.org'>Gabriele Musco</a>. Licensed under <a href='https://www.gnu.org/licenses/agpl-3.0.html'>GNU AGPLv3</a>.
    </small></p>
</footer>
</div>
            </div>
        </div>


</body>
</html>
