<!DOCTYPE html>
<html class="" lang="en"><head>
    
    <meta name="viewport" content="width=device-width" />
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=7" />

    <link
    rel="icon"
    href='/favicon.png'
/>
<link
    rel="shortcut icon"
    href='/favicon.ico'
    type="image/x-icon"
/>
<link
    rel="apple-touch-icon"
    href='/apple-touch-icon.png'
/>

    <link
        rel="icon"
        href='/logo.svg'
        type="image/svg+xml"
    />

<title>
        
            LACTF 2024 Writeups  &ndash;
        
        CT
    </title>

    
    <link href="/symbols-nerd-font/symbols-nerd-font.css" rel="stylesheet" integrity="sha512-lydow8GLOLlYNOtHlksNCmGWWCBsbIEtikXpHzfWqx78HLlyQZHOzyLwPpKol4Th6aCwLUXOfODVYgwrd3nwKQ=="/>
    <link href="/jetbrains-mono/jetbrains-mono.css" rel="stylesheet" integrity="sha512-tJxlgL6v1Y7kFf+qB8SloaAMKnOAw6WouknxXtIjkBux9Y/9aX81EUWOJO8c/3l98DmjG8brr4to7zaez606Fg=="/>

    
    
    <link type="text/css" rel="stylesheet" href=https://treseco.github.io/css/styles.0ea3e9989fc6c27bb0498cd610b6d9ded6962526e50b505d3792fd0711d4f9e482dc5d2aa5b4354def56902c72e5c414a550694cf084d53366e19485f2fdc477.css integrity="sha512-DqPpmJ/GwnuwSYzWELbZ3taWJSblC1BdN5L9BxHU&#43;eSC3F0qpbQ1Te9WkCxy5cQUpVBpTPCE1TNm4ZSF8v3Edw==" />
<meta name="author" content="" />

    
        <meta name="keywords" content='ctf write-up, LACTF 2024, reversing' />
    
    
        <meta name="description" content="e to participate in LACTF this weekend with WolvSec and it was a lot of fun. We ended up placing 166th in the open division. These are my writeups for glottem, the-secret-of-java-island and aplet321 reversing challenges. The archived challenges are availible here.
glottem Category: Rev Author: aplet123 Points: 455 Solves: 89 Description Haha glottem good!
Note: The correct flag is 34 characters long.
Files glottem: POSIX shell script, ASCII text executable, with very long lines" />
    

<meta property="og:site_name"
    content='CT' />

    <meta property="og:title" content="LACTF 2024 Writeups" />
    <meta property="og:type" content="article" />
    
    <meta
        property="article:author" content="" />
    <meta
        property="article:published_time"
        content='2024-02-18T19:26:46Z-0500' />
    
        
            <meta property="article:tag" content="ctf write-up" />
        
            <meta property="article:tag" content="LACTF 2024" />
        
            <meta property="article:tag" content="reversing" />
        
    
    <meta property="og:url" content="https://treseco.github.io/posts/lactf24/lactf24/" />
    
    
    <meta property="og:image"
        content="https://treseco.github.io/icon512.png" />
    
        <meta property="og:description" content="LACTF 2024 I was able to participate in LACTF this weekend with WolvSec and it was a lot of fun. We ended up placing 166th in the open division. These are my wr" />
    

<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:domain"
      content='reseco.github.io'
/>
<meta property="twitter:url" content="https://treseco.github.io/posts/lactf24/lactf24/" />


    <meta name="twitter:title" content="LACTF 2024 Writeups" />
    
    
    
    <meta name="twitter:image"
        content="https://treseco.github.io/icon512.png" />
    
        <meta name="twitter:description" content="LACTF 2024 I was able to participate in LACTF this weekend with WolvSec and it was a lot of fun. We ended up placing 166th in the open division. These are my wr" />
    

<link rel="manifest" href="/manifest/index.json" />
</head>


<body>
        <div id="baseContainer"><header class="">
<div class="titleAndSearchContainer">
        <div id="titleContainer">
            
                <a class="unstyledLink" href="/">
                    <img src='/logo.svg' alt='Logo'/>
                </a>
            
            <div class="rightOfLogo">
                <div class="titleAndHamburger">
                    <h1>
                        <a class="unstyledLink" href="/">CT</a>
                        
                    </h1>
                    
                        <label id="hamburger-menu" for="main-nav-toggler">
                            &#xf85b;
                        </label>
                    
                </div>
                <div id="wide_nav"><nav>
    
        <input type="checkbox" id="main-nav-toggler" />
    
    <ul id="main-nav">
        <li><a href="/">Home</a></li>
        
            <li><a href="/posts/">Posts</a></li>
        
        
        
        
        
            <li><a href="https://treseco.github.io/pages/about/">
                About
            </a></li>
        
        
        
            <li><a href="/tags/">Tags</a></li>
        
        
    </ul>
</nav>
</div>
            </div>
        </div>
        <div class="search">
    <input id="searchbar" type="text" placeholder='Search' />
    <span class="nerdlink" onclick="newSearch();">&#xf002;</span>
</div>
<script>
    function newSearch() {
        let term = searchbar.value.trim();
        if (!term) return;
        location.href = `/search/?q=${term}`;
    }
    searchbar.onkeyup = (ev) => {if (ev.keyCode == 13) newSearch()};
</script>

    </div>
    <div id="links">
        
        
        <a
    
        rel="noreferrer"
    
    target="_blank"
    class="nerdlink"
    href="https://github.com/treseco">
    
    
        &#xf09b;
    
    <span>
        Github
    </span>
</a>

    </div>
    

</header>
<div id="contentContainer">
                <div id="content">
                    <main>
<article class="card single">
    
        <h1>LACTF 2024 Writeups</h1>
    
    
        <p class="date">
            <span title='Date'>ï—¬ </span>
    2024-02-18

</p>
    
    
    
    
    <div><h1 id="lactf-2024">LACTF 2024</h1>
<p>I was able to participate in LACTF this weekend with <a href="https://wolvsec.org">WolvSec</a> and it was a lot of fun. We ended up placing 166th in the open division. These are my writeups for <code>glottem</code>, <code>the-secret-of-java-island</code> and <code>aplet321</code> reversing challenges. The archived challenges are availible <a href="https://github.com/uclaacm/lactf-archive">here</a>.</p>
<h2 id="glottem">glottem</h2>
<ul>
<li>Category: Rev</li>
<li>Author: aplet123</li>
<li>Points: 455</li>
<li>Solves: 89</li>
</ul>
<hr>
<h5 id="description">Description</h5>
<blockquote>
<p>Haha glottem good!</p>
<p>Note: The correct flag is 34 characters long.</p>
</blockquote>
<hr>
<h5 id="files">Files</h5>
<p><code>glottem</code>: POSIX shell script, ASCII text executable, with very long lines</p>
<hr>
<h5 id="solve">Solve</h5>
<p>The provided shell script</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/sh
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>1<span style="color:#e6db74">&lt;&lt;4201337
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">1//1,&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">exit=process.exit;argv=process.argv.slice(1)/*
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">4201337</span>
</span></span><span style="display:flex;"><span>read -p <span style="color:#e6db74">&#34;flag? &#34;</span> flag
</span></span><span style="display:flex;"><span>node $0 <span style="color:#e6db74">&#34;</span>$flag<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">&amp;&amp;</span> python3 $0 <span style="color:#e6db74">&#34;</span>$flag<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">&amp;&amp;</span> echo correct <span style="color:#f92672">||</span> echo incorrect
</span></span><span style="display:flex;"><span>1<span style="color:#e6db74">&lt;&lt;4201337
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">*///&#34;&#34;&#34;;from sys import argv
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">#// e = a very large 3 dimentional matrix, removed for brevity
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">alpha=&#34;abcdefghijklmnopqrstuvwxyz_&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">d=0;s=argv[1];1//1;&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">/*&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">#*/for (let i = 0; i &lt; s.length; i ++) {/*
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">for i in range(6,len(s)-2):
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    #*/d=(d*31+s.charCodeAt(i))%93097/*
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    d+=e[i-6][alpha.index(s[i])][alpha.index(s[i+1])]#*/}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">exit(+(d!=260,[d!=61343])[0])
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">4201337</span>
</span></span></code></pre></div><p>The script is challenging to read but it essentially creates a file that is both valid python and javascript, and checks the flag input against both programs.
Here is the resulting python file without the javascript comments:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>e <span style="color:#f92672">=</span> [ <span style="color:#f92672">...</span> ]
</span></span><span style="display:flex;"><span>alpha<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;abcdefghijklmnopqrstuvwxyz_&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># argv1 is the user provided flag string</span>
</span></span><span style="display:flex;"><span>d<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>; s<span style="color:#f92672">=</span>argv[<span style="color:#ae81ff">1</span>];<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">6</span>, len(s)<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>) :
</span></span><span style="display:flex;"><span>    d<span style="color:#f92672">+=</span>e[i<span style="color:#f92672">-</span><span style="color:#ae81ff">6</span>][alpha<span style="color:#f92672">.</span>index(s[i])][alpha<span style="color:#f92672">.</span>index(s[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>])]
</span></span><span style="display:flex;"><span><span style="color:#75715e"># d == 260 indicates the input flag passed the check</span>
</span></span><span style="display:flex;"><span>exit(d<span style="color:#f92672">!=</span><span style="color:#ae81ff">260</span>)
</span></span></code></pre></div><p>and the javascript file:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">e</span> <span style="color:#f92672">=</span> [ ... ]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">alpha</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;abcdefghijklmnopqrstuvwxyz_&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">d</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;<span style="color:#a6e22e">s</span><span style="color:#f92672">=</span><span style="color:#a6e22e">argv</span>[<span style="color:#ae81ff">1</span>];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">length</span>; <span style="color:#a6e22e">i</span> <span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">d</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">d</span><span style="color:#f92672">*</span><span style="color:#ae81ff">31</span><span style="color:#f92672">+</span><span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">charCodeAt</span>(<span style="color:#a6e22e">i</span>)) <span style="color:#f92672">%</span> <span style="color:#ae81ff">93097</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// d == 61343 indicates the input flag passed the check
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">process</span>.<span style="color:#a6e22e">exit</span>(<span style="color:#a6e22e">d</span><span style="color:#f92672">!=</span><span style="color:#ae81ff">61343</span>) 
</span></span></code></pre></div><p>Each of these programs applies some constraints on the possible correct flags, and together they form a verifier. I spent some time trying to use an SMT solver to solve for the flag, but this approach proved challengeing. Because the flag charcters that we are solving for are used to index into <code>e</code>, we really want concrete values rather than symbolic ones. The real insight comes from realizing that all the elements in <code>e</code> fall between <code>10 &lt;= x &lt;=17</code>. Since we are given that the flag is 34 chars long, and the python program only checks the chars from index 6 to 34-2, we know it checks the 26 chars between the brackets. Each of these chars increments <code>d</code> by a minimum of 10 and the total must be 260, thus each iteration of the loop must result in some element of <code>e</code> with the value 10.
With the resulting strings that correctly produce the sum of 260, we can compute the same check done by the javascript program until we find one that passes both.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>e <span style="color:#f92672">=</span> [ <span style="color:#f92672">...</span> ]
</span></span><span style="display:flex;"><span>alpha <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;abcdefghijklmnopqrstuvwxyz_&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># return all flag strings flag[idx:] with c at idx that result in all 10s</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">find_tens</span>(idx, c) :
</span></span><span style="display:flex;"><span>    tens <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    last_ten <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (idx <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">26</span>) : 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> [<span style="color:#e6db74">&#39;&#39;</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># assuming char c at flag[idx], find all indexes that produce a 10</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span>(e[idx][alpha<span style="color:#f92672">.</span>index(c)][last_ten<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>:]<span style="color:#f92672">.</span>count(<span style="color:#ae81ff">10</span>)) :
</span></span><span style="display:flex;"><span>        found_ten <span style="color:#f92672">=</span> e[idx][alpha<span style="color:#f92672">.</span>index(c)]<span style="color:#f92672">.</span>index(<span style="color:#ae81ff">10</span>, last_ten<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>        tens<span style="color:#f92672">.</span>append(found_ten)
</span></span><span style="display:flex;"><span>        last_ten <span style="color:#f92672">=</span> found_ten
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> tens:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> []
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> :
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># return all possible subsequent strings using recursion</span>
</span></span><span style="display:flex;"><span>        ret <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>        rec <span style="color:#f92672">=</span> [find_tens(idx<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>, alpha[g]) <span style="color:#66d9ef">for</span> g <span style="color:#f92672">in</span> tens]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> rec :
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> y <span style="color:#f92672">in</span> x :
</span></span><span style="display:flex;"><span>                ret<span style="color:#f92672">.</span>append(c<span style="color:#f92672">+</span>y)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> ret
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span><span style="color:#75715e"># do js program check</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">check_js</span>(flag) :
</span></span><span style="display:flex;"><span>    d <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> flag :
</span></span><span style="display:flex;"><span>        d <span style="color:#f92672">=</span> (d <span style="color:#f92672">*</span> <span style="color:#ae81ff">31</span> <span style="color:#f92672">+</span> ord(c)) <span style="color:#f92672">%</span> <span style="color:#ae81ff">93097</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> d
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i, c <span style="color:#f92672">in</span> enumerate(alpha) :
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># find all strings that produce 10s, try starting will all chars in alpha</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> s <span style="color:#f92672">in</span> find_tens(<span style="color:#ae81ff">0</span>, c) :
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> len(s) <span style="color:#f92672">==</span> <span style="color:#ae81ff">26</span> :
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> missing <span style="color:#f92672">in</span> alpha:
</span></span><span style="display:flex;"><span>                flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;lactf{&#34;</span> <span style="color:#f92672">+</span> s <span style="color:#f92672">+</span> missing <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;}&#39;</span>
</span></span><span style="display:flex;"><span>                score <span style="color:#f92672">=</span> check_js(flag)
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (score <span style="color:#f92672">==</span> <span style="color:#ae81ff">61343</span>) :
</span></span><span style="display:flex;"><span>                    print(flag)
</span></span></code></pre></div><p>The solve script will take a second to run, and will return a few possible flags but only one isn&rsquo;t completly random.</p>
<p><code>lactf{solve_one_get_two_free_deal}</code></p>
<h2 id="the-secret-of-java-island">the-secret-of-java-island</h2>
<ul>
<li>Category: Rev</li>
<li>Author: aplet123</li>
<li>Points: 312</li>
<li>Solves: 284</li>
</ul>
<hr>
<h5 id="description-1">Description</h5>
<blockquote>
<p>The Secret of Java Island is a 2024 point-and-click graphic adventure game developed and published by LA CTF Games. It takes place in a fictional version of Indonesia during the age of hacking. The player assumes the role of Benson Liu, a young man who dreams of becoming a hacker, and explores fictional flags while solving puzzles.</p>
</blockquote>
<hr>
<h5 id="files-1">Files</h5>
<p><code>game.jar</code>: Java archive data (JAR)</p>
<hr>
<h5 id="solve-1">Solve</h5>
<p>We are provide with a <code>jar</code> file that we can open with a tool like <a href="https://www.decompiler.com/">decompiler.com</a>. By looking at <code>JavaIsland.java</code> and running the file will show us that the program presents the user with a series of choices and will only print the flag when the correct sequence is executed. <code>JavaIsland.java</code> reveals that the target.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">case</span> 3<span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>         <span style="color:#66d9ef">if</span> <span style="color:#f92672">(!</span>hasGlove<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            story<span style="color:#f92672">.</span><span style="color:#a6e22e">setText</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;&lt;html&gt;You reach for the lever, plunging your hand into the thick veil of spider webs. While trying to pull the lever, you feel a sharp pain on your arm before your vision fades to black. Game over.&lt;/html&gt;&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>            button1<span style="color:#f92672">.</span><span style="color:#a6e22e">setText</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;I understand&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>            button2<span style="color:#f92672">.</span><span style="color:#a6e22e">setText</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;I understand&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>         <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            story<span style="color:#f92672">.</span><span style="color:#a6e22e">setText</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;&lt;html&gt;You reach for the lever, plunging your gloved hand into the thick veil of spider webs. The lever makes a loud creaking sound as you press it down, powering a large floodlight that lights up the entire room. When you look at your hand in the newfound light, you see several large spiders climbing on your glove. Startled, you shake the glove off and run to the other corner of the room, where you see a flag that must&#39;ve been there the entire time.&lt;/html&gt;&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>            button1<span style="color:#f92672">.</span><span style="color:#a6e22e">setText</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Read the flag&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>            button2<span style="color:#f92672">.</span><span style="color:#a6e22e">setText</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Read the flag&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>         <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>         <span style="color:#66d9ef">break</span><span style="color:#f92672">;</span>
</span></span></code></pre></div><p>Reaching the target involves entering case 3 with the golve item. By investigating the <code>trasitionState</code> method we can learn how to manipulate the state in order to reach case 3. In this method we find that we need to pass a check when in state 4 or else the program will exit.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>      <span style="color:#66d9ef">case</span> 4<span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>         <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>var0 <span style="color:#f92672">==</span> 0<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            exploit <span style="color:#f92672">=</span> exploit <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;d&#34;</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>            story<span style="color:#f92672">.</span><span style="color:#a6e22e">setText</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;You clobbered the DOM. That was exploit #&#34;</span> <span style="color:#f92672">+</span> exploit<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">()</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>         <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            exploit <span style="color:#f92672">=</span> exploit <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;p&#34;</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>            story<span style="color:#f92672">.</span><span style="color:#a6e22e">setText</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;You polluted the prototype. That was exploit #&#34;</span> <span style="color:#f92672">+</span> exploit<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">()</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>         <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>         <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>exploit<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">()</span> <span style="color:#f92672">==</span> 8<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>               MessageDigest var1 <span style="color:#f92672">=</span> MessageDigest<span style="color:#f92672">.</span><span style="color:#a6e22e">getInstance</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;SHA-256&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>               <span style="color:#66d9ef">if</span> <span style="color:#f92672">(!</span>Arrays<span style="color:#f92672">.</span><span style="color:#a6e22e">equals</span><span style="color:#f92672">(</span>var1<span style="color:#f92672">.</span><span style="color:#a6e22e">digest</span><span style="color:#f92672">(</span>exploit<span style="color:#f92672">.</span><span style="color:#a6e22e">getBytes</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;UTF-8&#34;</span><span style="color:#f92672">)),</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]{</span>69<span style="color:#f92672">,</span> 70<span style="color:#f92672">,</span> <span style="color:#f92672">-</span>81<span style="color:#f92672">,</span> <span style="color:#f92672">-</span>117<span style="color:#f92672">,</span> <span style="color:#f92672">-</span>10<span style="color:#f92672">,</span> 109<span style="color:#f92672">,</span> 15<span style="color:#f92672">,</span> 29<span style="color:#f92672">,</span> 19<span style="color:#f92672">,</span> 113<span style="color:#f92672">,</span> 61<span style="color:#f92672">,</span> <span style="color:#f92672">-</span>123<span style="color:#f92672">,</span> <span style="color:#f92672">-</span>39<span style="color:#f92672">,</span> 82<span style="color:#f92672">,</span> <span style="color:#f92672">-</span>11<span style="color:#f92672">,</span> <span style="color:#f92672">-</span>34<span style="color:#f92672">,</span> 104<span style="color:#f92672">,</span> <span style="color:#f92672">-</span>98<span style="color:#f92672">,</span> <span style="color:#f92672">-</span>111<span style="color:#f92672">,</span> 9<span style="color:#f92672">,</span> 43<span style="color:#f92672">,</span> 35<span style="color:#f92672">,</span> <span style="color:#f92672">-</span>19<span style="color:#f92672">,</span> 22<span style="color:#f92672">,</span> 52<span style="color:#f92672">,</span> <span style="color:#f92672">-</span>55<span style="color:#f92672">,</span> <span style="color:#f92672">-</span>124<span style="color:#f92672">,</span> <span style="color:#f92672">-</span>45<span style="color:#f92672">,</span> <span style="color:#f92672">-</span>72<span style="color:#f92672">,</span> <span style="color:#f92672">-</span>23<span style="color:#f92672">,</span> 96<span style="color:#f92672">,</span> <span style="color:#f92672">-</span>77<span style="color:#f92672">}))</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                  state <span style="color:#f92672">=</span> 7<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>               <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                  state <span style="color:#f92672">=</span> 6<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>               <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>               updateGame<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Exception var2<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>               <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> RuntimeException<span style="color:#f92672">(</span>var2<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>         <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>         <span style="color:#66d9ef">return</span><span style="color:#f92672">;</span>
</span></span></code></pre></div><p>Here the user is asked to make a series of 8 choices, and the series of choices is translated to a string. The string is then hashed and the resulting digest is checked against the correct hash. If the hash does not match we are sent to state 7 and the program exits. Because the string is a combination of &rsquo;d&rsquo;s and &lsquo;p&rsquo;s, we can hash all the possible strings with <code>sha256</code> to find the correct sequence of choices.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> hashlib
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> v <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x100</span>):
</span></span><span style="display:flex;"><span>    bits <span style="color:#f92672">=</span> [<span style="color:#ae81ff">1</span> <span style="color:#66d9ef">if</span> v <span style="color:#f92672">&amp;</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> (<span style="color:#ae81ff">7</span><span style="color:#f92672">-</span>n)) <span style="color:#66d9ef">else</span> <span style="color:#ae81ff">0</span> <span style="color:#66d9ef">for</span> n <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">8</span>)]
</span></span><span style="display:flex;"><span>    bs <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> bit <span style="color:#f92672">in</span> bits:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> bit <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>            bs <span style="color:#f92672">+=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;p&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            bs <span style="color:#f92672">+=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;d&#39;</span>
</span></span><span style="display:flex;"><span>    m <span style="color:#f92672">=</span> hashlib<span style="color:#f92672">.</span>sha256()
</span></span><span style="display:flex;"><span>    m<span style="color:#f92672">.</span>update(bs)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># check that hash matches first couple bytes in the correct hash</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(m<span style="color:#f92672">.</span>hexdigest()[<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">4</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;4546&#39;</span>):
</span></span><span style="display:flex;"><span>        print(bs)
</span></span></code></pre></div><p>This script will yield the sequence: <code>dpddpdpp</code>. we can now run the game, run this series of exploits at the computer then pull the lever to see the flag.</p>
<p><code>lactf{the_graphics_got_a_lot_worse_from_what_i_remembered}</code></p>
<h2 id="aplet321">aplet321</h2>
<ul>
<li>Category: Rev</li>
<li>Author: kaiphait</li>
<li>Points: 199</li>
<li>Solves: 445</li>
</ul>
<hr>
<h5 id="description-2">Description</h5>
<blockquote>
<p>Unlike Aplet123, Aplet321 might give you the flag if you beg him enough.</p>
<p><code>nc chall.lac.tf 31321</code></p>
</blockquote>
<hr>
<h5 id="files-2">Files</h5>
<p><code>aplet321</code>: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=b6322155d8e3d5ecbc678a2697ccce38be0e7c10, for GNU/Linux 3.2.0, not stripped</p>
<hr>
<h5 id="solve-2">Solve</h5>
<p>We are given an ELF file, opening the <code>main</code> function with ghidra&rsquo;s decompiler yeilds:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>undefined8 <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">void</span>)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// local declarations removed for brevity
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// [14] -r-x section size 553 named .text
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    sym.imp.<span style="color:#a6e22e">setbuf</span>(_reloc.stdout, <span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>    sym.imp.<span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;hi, i</span><span style="color:#ae81ff">\&#39;</span><span style="color:#e6db74">m aplet321. how can i help?&#34;</span>);
</span></span><span style="display:flex;"><span>    sym.imp.<span style="color:#a6e22e">fgets</span>(<span style="color:#f92672">&amp;</span>var_238h, <span style="color:#ae81ff">0x200</span>, _reloc.stdin);
</span></span><span style="display:flex;"><span>    uVar2 <span style="color:#f92672">=</span> sym.imp.<span style="color:#a6e22e">strlen</span>(<span style="color:#f92672">&amp;</span>var_238h);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#ae81ff">5</span> <span style="color:#f92672">&lt;</span> uVar2) {
</span></span><span style="display:flex;"><span>        iVar5 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>        iVar6 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>        piVar4 <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>var_238h;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">do</span> {
</span></span><span style="display:flex;"><span>            iVar1 <span style="color:#f92672">=</span> sym.imp.<span style="color:#a6e22e">strncmp</span>(piVar4, <span style="color:#e6db74">&#34;pretty&#34;</span>, <span style="color:#ae81ff">6</span>);
</span></span><span style="display:flex;"><span>            iVar6 <span style="color:#f92672">=</span> iVar6 <span style="color:#f92672">+</span> (<span style="color:#66d9ef">uint32_t</span>)(iVar1 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>            iVar1 <span style="color:#f92672">=</span> sym.imp.<span style="color:#a6e22e">strncmp</span>(piVar4, <span style="color:#e6db74">&#34;please&#34;</span>, <span style="color:#ae81ff">6</span>);
</span></span><span style="display:flex;"><span>            iVar5 <span style="color:#f92672">=</span> iVar5 <span style="color:#f92672">+</span> (<span style="color:#66d9ef">uint32_t</span>)(iVar1 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>            piVar4 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">int64_t</span> <span style="color:#f92672">*</span>)((<span style="color:#66d9ef">int64_t</span>)piVar4 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">while</span> (piVar4 <span style="color:#f92672">!=</span> (<span style="color:#66d9ef">int64_t</span> <span style="color:#f92672">*</span>)((<span style="color:#66d9ef">int64_t</span>)<span style="color:#f92672">&amp;</span>var_238h <span style="color:#f92672">+</span> (<span style="color:#66d9ef">uint64_t</span>)((<span style="color:#66d9ef">int32_t</span>)uVar2 <span style="color:#f92672">-</span> <span style="color:#ae81ff">6</span>) <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>));
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (iVar5 <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>            iVar3 <span style="color:#f92672">=</span> sym.imp.<span style="color:#a6e22e">strstr</span>(<span style="color:#f92672">&amp;</span>var_238h, <span style="color:#e6db74">&#34;flag&#34;</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (iVar3 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>                sym.imp.<span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;sorry, i didn</span><span style="color:#ae81ff">\&#39;</span><span style="color:#e6db74">t understand what you mean&#34;</span>);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> ((iVar6 <span style="color:#f92672">+</span> iVar5 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x36</span>) <span style="color:#f92672">&amp;&amp;</span> (iVar6 <span style="color:#f92672">-</span> iVar5 <span style="color:#f92672">==</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0x18</span>)) {
</span></span><span style="display:flex;"><span>                sym.imp.<span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;ok here</span><span style="color:#ae81ff">\&#39;</span><span style="color:#e6db74">s your flag&#34;</span>);
</span></span><span style="display:flex;"><span>                sym.imp.<span style="color:#a6e22e">system</span>(<span style="color:#e6db74">&#34;cat flag.txt&#34;</span>);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            sym.imp.<span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;sorry, i</span><span style="color:#ae81ff">\&#39;</span><span style="color:#e6db74">m not allowed to do that&#34;</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    sym.imp.<span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;so rude&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Here we can see that the program reads in some input and saves it to a buffer. We can also see the call to <code>system(&quot;cat flag.txt&quot;)</code> which is our target. We just need to find the input that results in the program reaching the target. To do this we can turn all the conditional checks into a system of equations. First the input must be longer than 5 characters, and needs to contain the word flag. Next, the words &lsquo;pretty&rsquo; and &lsquo;please&rsquo; need to show up at exactly 56 times, and &lsquo;please&rsquo; needs to show up 24 times more than &lsquo;pretty&rsquo;.</p>
<pre tabindex="0"><code>num_pretty + num_please = 56
num_please - num_pretty = 24

num_pretty = 15
num_please = 39
</code></pre><p>We can now craft our input and send it to the remote server.</p>
<pre tabindex="0"><code>$ python3 -c &#39;print(&#34;pretty &#34; * 15 + &#34;please &#34; * 39 + &#34;flag&#34;)&#39; | nc chall.lac.tf 31321
hi, i&#39;m aplet321. how can i help?
ok here&#39;s your flag
lactf{next_year_i&#39;ll_make_aplet456_hqp3c1a7bip5bmnc}
</code></pre><p>flag: <code>lactf{next_year_i'll_make_aplet456_hqp3c1a7bip5bmnc}</code></p>
</div>
</article>

    <hr />
    <p class="articleTagsContainer">
        <span>ï€« </span>
        <strong>Tags:</strong>
        
            <a
                
                href="/tags/ctf-write-up/">#ctf write-up</a>
        
            <a
                
                href="/tags/lactf-2024/">#LACTF 2024</a>
        
            <a
                
                href="/tags/reversing/">#reversing</a>
        
    </p>






                    </main><footer>
    <hr />

<p><small>
        2024 &copy; 
    </small></p>
    <p><small>
        <a href='https://gitlab.com/gabmus/hugo-ficurinia'>Ficurinia theme</a> for <a href='https://gohugo.io'>Hugo</a> by <a href='https://gabmus.org'>Gabriele Musco</a>. Licensed under <a href='https://www.gnu.org/licenses/agpl-3.0.html'>GNU AGPLv3</a>.
    </small></p>
</footer>
</div>
            </div>
        </div>


</body>
</html>
